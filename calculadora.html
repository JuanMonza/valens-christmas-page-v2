<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="icon" href="medios/logo valents.PNG" type="image/png">
  <link rel="stylesheet" href="assets/styles.css" />
  <title>Calculadora Mágica - Valens Christmas</title>
</head>

<body style="background-image: url('medios/fondo-de-navidad-con-copos-de-nieve-y-luces-bokeh.jpg'); background-size: cover; background-position: center; background-attachment: fixed;">
  <canvas id="snow-canvas"
    style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:99999;opacity:0.7;"></canvas>
  
  <div id="navbar"></div>

  <main>
    <section id="calculadora" class="content-section"
        style="background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); border-radius: 15px; margin: 20px auto; padding: 40px; max-width: 1200px;">
        <h2>Calculadora Mágica de Decoración</h2>
        <p style="max-width: 600px; margin: 0 auto 2rem; color: var(--color-dark);">Descubre la cantidad perfecta de
            adornos para crear tu árbol navideño soñado</p>
        <div class="calculator-box mejorada">
            <div class="input-group">
                <label for="tree_height">Altura del árbol (en metros)</label>
                <input type="range" id="tree_height" name="tree_height" min="1" max="3" step="0.1" value="1.5">
                <div class="height-display-container">
                    <span>1m</span>
                    <span id="height_display">1.5</span>
                    <span>3m</span>
                </div>
            </div>

            <fieldset>
                <legend>Tipo de árbol</legend>
                <div class="tree-options-container">
                    <label class="tree-option selected">
                        <input type="radio" name="tree_type" value="slim" checked>
                        Árbol delgado
                    </label>
                    <label class="tree-option">
                        <input type="radio" name="tree_type" value="standard">
                        Árbol estándar
                    </label>
                    <label class="tree-option">
                        <input type="radio" name="tree_type" value="dense">
                        Árbol frondoso
                    </label>
                </div>
            </fieldset>

            <button id="calculate_btn">
                Calcular adornos
            </button>

            <div id="results">
                <h3>Resultados aproximados:</h3>
                <div class="results-content">
                    <div class="result-item">
                        <strong>Esferas:</strong>
                        <span id="res_ornaments">0</span>
                    </div>
                    <div class="result-item">
                        <strong>Moños:</strong>
                        <span id="res_bows">0</span>
                    </div>
                    <div class="result-item">
                        <strong>Guirnalda (metros):</strong>
                        <span id="res_garland">0</span>
                    </div>
                    <div class="result-item">
                        <strong>Luces LED:</strong>
                        <span id="res_lights">0</span>
                        <span id="res_lights_bulbs"></span>
                    </div>
                </div>
            </div>
        </div>
    </section>
  </main>

  <div id="footer"></div>

  <script type="module">
        import { renderNavbar, navbarScript } from './assets/navbar.js';
        import { renderFooter } from './assets/footer.js';
        document.getElementById('navbar').innerHTML = renderNavbar();
        document.getElementById('footer').innerHTML = renderFooter();
        navbarScript();
    </script>

    <audio id="christmas-audio" loop preload="auto" style="display:none;">
        <source src="medios/christmas-party-time-249613.mp3" type="audio/mpeg">
    </audio>
    <script src="assets/music-persistence.js"></script>
    <script src="assets/snow-effect.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
        const heightInput = document.getElementById('tree_height');
        const heightDisplay = document.getElementById('height_display');
        const treeOptions = document.querySelectorAll('.tree-option');
        const results = document.getElementById('results');
        const calculateBtn = document.getElementById('calculate_btn');

        // Asignar evento al botón
        calculateBtn.addEventListener('click', calculateOrnaments);

        // Actualizar display de altura
        heightInput.addEventListener('input', function () {
            heightDisplay.textContent = parseFloat(this.value).toFixed(1);
        });

        // Efecto de selección en las opciones de árbol
        treeOptions.forEach(option => {
            option.addEventListener('click', function () {
                treeOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        // Función de cálculo
        function calculateOrnaments() {
            const height = parseFloat(heightInput.value);
            const type = document.querySelector('input[name="tree_type"]:checked').value;

            // Factores de multiplicación según el tipo (basados en guías profesionales)
            const factors = {
                slim: 0.75,    // Árbol delgado requiere 25% menos adornos
                standard: 1,    // Árbol clásico como base
                dense: 1.35    // Árbol frondoso requiere 35% más adornos
            };

            // Cálculos profesionales basados en estándares de decoración
            // Para un árbol estándar:
            // - 40 esferas por metro de altura
            // - 12 moños por metro de altura
            // - 5 metros de guirnalda por metro de altura
            // - 12 metros de luces LED por metro de altura (100 bombillas por metro)
            const baseOrnaments = Math.round(40 * height * factors[type]);
            const baseBows = Math.round(12 * height * factors[type]);
            const baseGarland = Math.round(5 * height * factors[type]);

            // Cálculo de luces LED
            // Se multiplica por π para considerar el perímetro del árbol en cada vuelta
            // y por el número de vueltas necesarias para una buena cobertura
            const baseLights = Math.round(12 * height * factors[type]);
            const numBulbs = baseLights * 100; // 100 bombillas por metro

            // Animación de resultados
            results.classList.add('show');
            setTimeout(() => {
                // Animación de números
                animateNumber('res_ornaments', baseOrnaments);
                animateNumber('res_bows', baseBows);
                animateNumber('res_garland', baseGarland);
                animateNumber('res_lights', baseLights);
                document.getElementById('res_lights_bulbs').textContent = `(${numBulbs} bombillas)`;
            }, 100);
        }

        // Función para animar números
        function animateNumber(elementId, final) {
            const element = document.getElementById(elementId);
            const duration = 1000;
            const start = 0;
            const increment = final / (duration / 16);
            let current = start;

            const timer = setInterval(() => {
                current += increment;
                if (current >= final) {
                    clearInterval(timer);
                    element.textContent = final;
                } else {
                    element.textContent = Math.round(current);
                }
            }, 16);
        }
    });
  </script>
</body>
</html>
